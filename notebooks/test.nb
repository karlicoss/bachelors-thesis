(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     10187,        296]
NotebookOptionsPosition[      8881,        250]
NotebookOutlinePosition[      9216,        265]
CellTagsIndexPosition[      9173,        262]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "f", "]"}], "\[IndentingNewLine]", 
 RowBox[{"a", " ", ":=", " ", "5.0"}], "\[IndentingNewLine]", 
 RowBox[{"L", " ", ":=", " ", "2.0"}], "\[IndentingNewLine]", 
 RowBox[{"V0", " ", ":=", " ", "11.0"}], "\[IndentingNewLine]", 
 RowBox[{"En", " ", ":=", " ", "20.0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"x_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
  RowBox[{"Sin", "[", "x", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "[", 
   RowBox[{"x_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", " ", "<", " ", "L"}], ",", "V0", ",", "0.0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"f", "''"}], "[", "x", "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"V", "[", "x", "]"}], " ", "*", " ", 
        RowBox[{"f", "[", "x", "]"}]}], " ", "-", " ", 
       RowBox[{"En", " ", "*", " ", 
        RowBox[{"f", "[", "x", "]"}]}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0.0", ",", "a"}], "}"}]}], "]"}], " ", "+", " ", 
  RowBox[{
   RowBox[{"f", "[", "a", "]"}], " ", "*", " ", 
   RowBox[{
    RowBox[{"f", "'"}], "[", "a", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.603552029632553*^9, 3.603552041544382*^9}, {
  3.603552094775861*^9, 3.603552095756762*^9}, {3.6035524399333*^9, 
  3.603552440156711*^9}, {3.603552544969083*^9, 3.60355254531689*^9}, {
  3.603552632371161*^9, 3.603552643014323*^9}, {3.603552755169656*^9, 
  3.603552768000362*^9}, {3.603552805821534*^9, 3.603552807388156*^9}, {
  3.60355297153762*^9, 3.6035530037390137`*^9}, {3.6035530452246943`*^9, 
  3.603553094361053*^9}, {3.60355314456938*^9, 3.6035532258860703`*^9}, {
  3.603553307169243*^9, 3.603553314017763*^9}, {3.603554298073325*^9, 
  3.603554302603777*^9}, {3.603558367855404*^9, 3.603558375084866*^9}, {
  3.6035584180741653`*^9, 3.603558419358585*^9}, {3.6035584529516993`*^9, 
  3.60355847255192*^9}, {3.60355852141228*^9, 3.603558522764063*^9}, {
  3.603559438288669*^9, 3.6035594394777803`*^9}, {3.603560200420308*^9, 
  3.603560200718842*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical integration converging too slowly; suspect one \
of the following: singularity, value of the integration is 0, highly \
oscillatory integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.603558460577168*^9, 3.603558502601693*^9, 3.603559441820491*^9, {
   3.603560194416904*^9, 3.603560202297502*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] recursive bisections in \[NoBreak]\\!\\(x\\)\
\[NoBreak] near \[NoBreak]\\!\\({x}\\)\[NoBreak] = \
\[NoBreak]\\!\\({2.001875416797338`}\\)\[NoBreak]. NIntegrate obtained \
\[NoBreak]\\!\\(-37.000433765841656`\\)\[NoBreak] and \
\[NoBreak]\\!\\(0.004808709371923528`\\)\[NoBreak] for the integral and error \
estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvb\\\
\", ButtonNote -> \\\"NIntegrate::ncvb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.603558460577168*^9, 3.603558502601693*^9, 3.603559441820491*^9, {
   3.603560194416904*^9, 3.603560202360181*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"k", " ", ":=", " ", 
  RowBox[{"Sqrt", "[", "En", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aaa", " ", ":=", " ", 
  RowBox[{"-", "37.272444321286336`"}]}], "\[IndentingNewLine]", 
 RowBox[{"X", " ", ":=", " ", 
  RowBox[{"aaa", " ", "/", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Sin", "[", "a", "]"}], ")"}], "^", 
    "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"U", " ", ":=", " ", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", " ", "2"}], " ", "*", " ", "I", " ", "*", " ", "k", " ", 
     "*", " ", "a"}], "]"}], " ", "*", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"I", " ", "*", " ", "k"}], " ", "+", " ", "X"}], ")"}], " ", 
    "/", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"I", " ", "*", " ", "k"}], " ", "-", " ", "X"}], ")"}], 
    " "}]}]}]}], "Input",
 CellChangeTimes->{{3.6035602773501062`*^9, 3.603560293803059*^9}, {
  3.603560365981008*^9, 3.603560369750251*^9}, {3.603560526107709*^9, 
  3.603560577628869*^9}, {3.603560764062468*^9, 3.603560768482202*^9}}],

Cell[BoxData["U"], "Input",
 CellChangeTimes->{
  3.603560580657542*^9, {3.6035606113328943`*^9, 3.60356061359092*^9}, {
   3.603560687240769*^9, 3.603560735639142*^9}, 3.603560777611147*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"psiE", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "*", " ", "k", " ", "*", " ", "x"}], "]"}], 
    " ", "+", " ", 
    RowBox[{"U", " ", "*", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "*", " ", "k", " ", "*", " ", "x"}], "]"}]}]}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6035612525832167`*^9, 3.603561309822074*^9}, 
   3.603561365501342*^9, 3.60356142838767*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"con", " ", ":=", " ", 
   RowBox[{
    RowBox[{"psiE", "[", "a", "]"}], " ", "/", " ", 
    RowBox[{"Sin", "[", "a", "]"}]}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.603561433755219*^9, 3.6035614600718393`*^9}}],

Cell[BoxData["con"], "Input",
 CellChangeTimes->{{3.6035614628011017`*^9, 3.603561463191107*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"con", " ", "*", " ", 
  RowBox[{
   RowBox[{"f", "'"}], "[", "a", "]"}]}]], "Input",
 CellChangeTimes->{{3.603561501971705*^9, 3.6035615108615637`*^9}}],

Cell[BoxData[
 RowBox[{"0.029927018433961304`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.05756630119140073`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.603561511557754*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"psiE", "'"}], "[", "a", "]"}]], "Input",
 CellChangeTimes->{{3.603561514922781*^9, 3.6035615204263906`*^9}}],

Cell[BoxData[
 RowBox[{"4.100771480938962`", "\[VeryThinSpace]", "+", 
  RowBox[{"7.888064315854099`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.603561521602762*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"C", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.603561291322741*^9, 3.603561297697377*^9}, {
   3.603561328375992*^9, 3.603561353450008*^9}, 3.603561425918371*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.10116873490822487`"}], "-", 
  RowBox[{"0.1946037450316418`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.603561353719088*^9, 3.6035613725903263`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.603561347069017*^9, 3.6035613471074266`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.603561326410693*^9, 3.603561326778936*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.603561320645391*^9, 3.6035613240733213`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["psi", "\[Prime]",
   MultilineFunction->None], "[", "5.`", "]"}]], "Input",
 CellChangeTimes->{3.603561312237142*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["psi", "\[Prime]",
   MultilineFunction->None], "[", "5.`", "]"}]], "Output",
 CellChangeTimes->{3.603561312312646*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Arg", "[", "U", "]"}]], "Input",
 CellChangeTimes->{
  3.6035607832639027`*^9, {3.603560898875701*^9, 3.603560901299304*^9}}],

Cell[BoxData["2.1827580448197366`"], "Output",
 CellChangeTimes->{3.6035609016820383`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.60356077426542*^9, 3.6035607743022842`*^9}}]
},
WindowSize->{1600, 850},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 2288, 50, 187, "Input"],
Cell[2870, 74, 675, 13, 24, "Message"],
Cell[3548, 89, 894, 16, 43, "Message"]
}, Open  ]],
Cell[4457, 108, 1065, 28, 99, InheritFromParent],
Cell[5525, 138, 191, 3, 32, "Input"],
Cell[5719, 143, 553, 15, 55, InheritFromParent],
Cell[6275, 160, 265, 6, 55, "Input"],
Cell[6543, 168, 97, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[6665, 173, 176, 4, 32, InheritFromParent],
Cell[6844, 179, 186, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7067, 187, 143, 3, 32, "Input"],
Cell[7213, 192, 181, 3, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7431, 200, 200, 3, 55, "Input"],
Cell[7634, 205, 208, 4, 32, "Output"]
}, Open  ]],
Cell[7857, 212, 94, 1, 32, InheritFromParent],
Cell[7954, 215, 92, 1, 32, "Input"],
Cell[8049, 218, 94, 1, 32, InheritFromParent],
Cell[CellGroupData[{
Cell[8168, 223, 159, 4, 32, InheritFromParent],
Cell[8330, 229, 160, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8527, 238, 149, 3, 32, "Input"],
Cell[8679, 243, 90, 1, 32, "Output"]
}, Open  ]],
Cell[8784, 247, 93, 1, 32, InheritFromParent]
}
]
*)

(* End of internal cache information *)

