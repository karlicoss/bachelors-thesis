\chapter{Обзор предметной области}
\label{chapter1}

\todo{Почитать что такое контакданс}

% TODO https://en.wikipedia.org/wiki/Partial_differential_equation#Existence_and_uniqueness !!!!!

\section{Аксиоматизация квантовой механики}

% http://thisquantumworld.com/wp/a-critique-of-quantum-mechanics/the-standard-axioms/
\begin{easylist}[itemize]
# с каждой физической системой ассоциировано сепарабельное гильбертово пространство $\hilb{}$ над полем комплексных чисел $\bbC$ со скалярным произведением $\ipcdot$. Состояния квантовой системы — элементы $\hilb{}$, имеющие единичную норму, которые также называются \textit{волновыми функциями};
# каждая \textit{наблюдаемая} физическая величина $a$ (координата, импульс, спин, энергия, и т.д.) ассоциирована с самосопряженным оператором $A$ (возможно, неограниченным), плотно определенным в пространстве $\hilb{}$. Множество возможных значений наблюдаемой — её спектр $\sigma(A)$, который для самосопряженного оператора вещественнен и состоит из дискретной и непрерывной части;
# информация о наблюдаемой может быть получена проверкой принадлежности ее значения борелевскому множеству $X \subseteq \bbR$:
% (что физически соответствует «точности» прибора: чем точнее прибор, тем меньшей меры множество мы можем протестировать):
## вероятность значения наблюдаемой принадлежать $X$ рассчитывается как $\| \xi_A(X) \Psi \|^2 = \ip{\Psi}{\xi_A(X) \Psi}$
### в частности, математическое ожидание значения наблюдаемой $A$ в состоянии $\Psi$ равно $\ip{\Psi}{A \Psi}$.
### \textit{плотностью вероятности} волновой функции $\Psi$ называется функция $\rho(x) = \|\Psi(x)|^2$
%\todo{соответствует единичному оператору? Что бы это значило?}
## после измерения состояние системы проецируется на подпространство, натянутое на собственные функции, соответствующие элементам спектра в $X$, то есть: $\Psi \mapsto \frac{\xi_A(X) \Psi}{\| \xi_A(X) \Psi \|}$;
# временная эволюция системы задается однопараметрической унитарной группой $U(t)$, генератором которой является гамильтониан $H$, то есть оператор полной энергии системы;
## в частности, $\Psi(t) = U(t) \Psi_0$
\end{easylist}

\section{Уравнение Шредингера}
Уравнение Шредингера описывает временную эволюцию чистых состояний нерелятивистсих квантовых систем во времени. Фактически, оно эквивалентно определению генератора группы $U(t)$, и имеет форму:
\[
\iu \hbar \pdv{t} \Psi(t) = H \Psi(t)
\]
, где $\iu$ — мнимая единица, $\hbar$ — приведенная постоянная Планка, $H$ — гамильтониан, оператор полной энергии системы, спектр представляет собой множество возможных значений энергии системы, которые можно получить при ее измерении.

Для каждой квантовой системы гамильтониан свой, и его форму надо «угадывать» по физическим экспериментам.

Гамильтониан для частицы в потенциальном поле выражается как:
\[
H = - \frac{\hbar^2}{2 m} \laplacian + V(\vb{r}, t)
\]

\section{Ток вероятности}
Ток вероятности (англ. probability current) — величина, описывающая «течение» волновой функции через единицу поверхности за единицу времени. \todo{мутно} Для частицы в потенциальном поле ток вероятности выражается как:
\[
\vb{j}(\vb{r}, t) = \frac{\hbar}{2 m \iu} (\cconj{\psi(\vb{r}, t)} \grad{\psi(\vb{r}, t)} - \psi(\vb{r}, t) \grad{\cconj{\psi(\vb{r}, t)})}
\]

\section{Коэффициент прохождения}
Интуитивно, коэффициент прохождения — отношение «количества» волны, прошедшей через барьер к «количеству» волны, на этот барьер падающий. «Количество» волны должно быть связяно с током вероятности $\vb{j}(\vb{r}, t)$, однако ток является векторной величиной, и функцией нескольких аргументов, тогда как хотелось бы получить характерное скалярное значение. Можно заметить, что:

\begin{easylist}[itemize]
# ток вероятности не зависит от времени для не изменяемой во времени конфигурации системы;
# если в системе можно выделить направление распространения волны, по этому направлению идет основной поток, остальные либо зануляются из-за симметрии, либо ими можно пренебречь;
# если в системе можно выделить сечение, перпендикулярное направлению распространения волны, по нему можно проинтегрировать ток вероятности.
\end{easylist}

В результате этого получаем величины $J_{inc}$ и $J_{trans}$, которые характеризуют входящий и прошедний потоки соответственно. 

Коэффициент прохождения определяется как
\[
T = \frac{|J_{trans}|}{|J_{inc}|}
\]

\section{Фиксирование нотации}
\subsection{Различные обозначения}

\begin{ilist}
# Жирным обозначаются элементы — вектора: к примеру, $\vb{x} \in \bbR^n$
# Сопряжение комплексных чисел обозначается как $\cconj{c}$
# Сопряжение операторов обозначается как $A^*$
# \todo{что-нибудь про ветку квадратного корня}
\end{ilist}

\subsection{Атомная система единиц}
% https://en.wikipedia.org/wiki/Atomic_units
% http://www.phys.ubbcluj.ro/~vchis/cursuri/cspm/course2.pdf
В данной работе все расчеты ведутся в атомной системе единиц Хартри (англ. Hartree atomic units, далее АСЕ). В ней нормализуются следующие константы:

\begin{table}[h]
\begin{tabular}{|l|l|l|}
\hline
Величина & Значение в АСЕ & Значение в СИ \\\hline
Приведенная постонная Планка $\hbar$ & 1 & $\approx$ \num{1.5e-34}\si{\joule\second} \\\hline
Масса электрона $m_e$ & 1 &  $\approx$ \num{9.1e-31}\si{\kilo\meter} \\\hline
Заряд электрона $e$   & 1 & $\approx$ \num{1.6e-19}\si{\ampere\second} \\\hline
\end{tabular}
\end{table}

% Производными единицами будут \todo{TODO}:

% \begin{table}[h]
% \begin{tabular}{|l|l|l|}
% \hline
% Величина & Значение в АСЕ & Значение в СИ \\\hline
% Приведенная постонная Планка $\hbar$ & 1 & \\\hline
% Масса электрона $m_e$ & 1 &  9.1  \\\hline
% Заряд электрона $e$   & 1 & \\\hline
% \end{tabular}
% \end{table}

\textbf{Далее, если не будет оговорено иное, все квантомеханические уравнения и вычисления будут приведены в АСЕ.}

\subsection{Функция Грина}
Термин «функция Грина» используется в двух значениях:

\begin{itemize}
\item как интегральное ядро резольвентного оператора: $G(\vb{x}, \vb{s}; \lambda)$ — ядро оператора $R(\lambda) = \frac{1}{\lambda I - L}$;
\item как решение дифференциального уравнения $L_x G(\vb{x}, \vb{s}) = -\delta(\vb{x} - \vb{s})$, где $\delta$ — многомерная дельта-функция Дирака.
\end{itemize}

Также в физике и математике сложилась небольшая неоднозначность в определении функции Грина:

\begin{itemize}
\item в физике: $L_x G(\vb{x}, \vb{s}) = -\delta(\vb{x} - \vb{s})$;
\item в математике: $L_x G(\vb{x}, \vb{s}) = \delta(\vb{x} - \vb{s})$.
\end{itemize} 

Мы будем использовать \textbf{физическую} нотацию в данной работе. В частности, это означает, что спектральное представление функции Грина выглядит как: 

\[
G(\vb{x}, \vb{s}) = -\sum\limits_n \frac{\psi_n(\vb{x}) \psi_n^*(\vb{s})}{\lambda_n}
\]

\subsection{Скалярное произведение}
В определении скалярного произведения в комплексном векторном пространстве $V$ существует следующая неоднозначность:

\begin{itemize}
\item В физике: \textbf{анти}линейно по \textit{первому} аргументу, линейно по \textit{второму}:
\[
\forall \vb{x}, \vb{y}, \vb{z} \in V: \forall a, b \in \bbC: \ip{a\vb{x} + b\vb{y}}{\vb{z}} = \cconj{a} \ip{\vb{x}}{\vb{z}} + \cconj{b} \ip{\vb{y}}{\vb{z}}
\]
\[
\forall \vb{x}, \vb{y}, \vb{z} \in V: \forall a, b \in \bbC: \ip{\vb{x}}{a\vb{y} + b\vb{z}} = a \ip{\vb{x}}{\vb{y}} + b \ip{\vb{x}}{\vb{y}}
\]
\item В математике: линейно по \textit{первому} аргументу, \textbf{анти}линейно по \textit{второму}:
\[
\forall \vb{x}, \vb{y}, \vb{z} \in V: \forall a, b \in \bbC: \ip{a\vb{x} + b\vb{y}}{\vb{z}} = a \ip{\vb{x}}{\vb{z}} + b \ip{\vb{y}}{\vb{z}}
\]
\[
\forall \vb{x}, \vb{y}, \vb{z} \in V: \forall a, b \in \bbC: \ip{\vb{x}}{a\vb{y} + b\vb{z}} = \cconj{a} \ip{\vb{x}}{\vb{y}} + \cconj{b} \ip{\vb{x}}{\vb{y}}
\]
\end{itemize}

В данной работе используется \textbf{физическая} нотация. В частности, это означает, что скалярное произведение в $L^2(E)$ определено как $\ip{f}{g} = \int\limits_E \cconj{f(\vb{x})} g(\vb{x}) \dd \vb{x}$.

% TODO: написать про то, что были ранее исслодованы условия Неймана, но они не физические
% \section{Различные граничные условия для уравнения Шредингера}
% \subsection{Условия Неймана}
% \subsection{Условия Дирихле}

\section{Самосопряженные расширения симметрических операторов}
В квантовой механике все операторы, соотвтетствующие наблюдаемым, в частности, гамильтониан, который задает динамику квантовой системы, должны быть самосопряженными. Часто бывает так, что оператор задается некоторым формальным выражением на некотором домене из каких-то физических соображений, но он оказывается симметрическим, а не самосопряженным. Такой оператор не может задавать динамику системы, так как не всегда является генератором однопараметрической унитарной группы.

Известно соотношение: $\dom A \subseteq \dom A^*$. Из него можно понять, что если дополнить домен оператора какими-либо функциями, домен сопряженного оператора при этом будет сужаться. Можно провести эту процедуру так, чтобы в итоге домены исходного и сопряженного оператора совпали. Однако расширение оператора до самосопряженного происходит не всегда однозначно.

Пусть $A$ — замкнутый симметрический оператор. Тогда определим:
\begin{align*}
K_+ &= \ker (A^* + i) \\
k_+ &= \dim K_+ \\
K_- &= \ker (A^* - i) \\
k_- &= \dim K_-
\end{align*}
$K_+, K_-$ называются дефектными подпространствами оператора $A$, $k_+, k_-$ — его индексами дефекта.

Известна теорема фон Неймана, которая более точно описывает соотношение $\dom A \subseteq \dom A^*$: если $A$ — замкнутый симметрический оператор, то $\dom A^* = \dom A \oplus K_+ \oplus K_-$.

Из этой теоремы сразу видно, что индексы дефекта нулевые тогда и только тогда, когда оператор самосопряжен ($\dom A^* = \dom A$). Более общим утверждением является следущее:

Симметрический замкнутый оператор $A$ имеет самосопряженные расширения тогда и только тогда, когда его индексы дефекта равны: $k_+ = k_- = k$. При этом его все его самосопряженные расширения параметризуются унитарными матрицами размера $k \times k$ (которые однозначно определяются $k^2$ вещественными параметрами). Выбор конкретного расширения должен быть осуществлен уже с учетом желаемых свойств соответствующей оператору физической величины.
% Bonneau
% TODO \todo{написать, чем собственно дополняются домены}
\section{Пространства с индефинитным скалярным произведением}
% On Extensions of Indefinite Functions Defined on a Rectangle
В физике иногда приходится прибегать к обобщениям гильбертовых пространств. Рассмотрим некоторые из них.

\todo{Гильбертово пространство}

Пара $(X, \ipcdot)$ называется пространством с индефинитным скалярным произведением, если $\ipcdot: X \times X \to \bbC$ — эрмитова форма. От гильбертовых пространств оно отличается ослаблением требования положительной определенности скалярного произведения.

Линейное подпространство $Y$ пространства с индефинитным скалярным произведением $X$ называется:
\begin{ilist}
# положительным если $\forall y \in Y: y \ne 0: \ip{y}{y} > 0$;
# отрицательным, если $\forall y \in Y: y \ne 0: \ip{y}{y} < 0$;
# нейтральным, если $\forall y \in Y: y \ne 0: \ip{y}{y} = 0$.
\end{ilist}
В частности, любое гильбертово пространство полностью положительно.

Антипространством пространства $(X, \ip{}{})$, называется пространство $(X, -\ip{}{})$.

Пространством Крейна называется пространство с индефинитным скалярным произведением, которое может быть записано в виде прямой суммы $X = X^+ \oplus X^-$, где суммы $X^+$ — гильбертово пространсво, а $X^-$ — пространство, антипространство которого является гильбертовым (далее обозначим это антипространство как $|X^-|$). гильбертова пространства и антигильбертова. Такое представление называется фундаментальным разложением. Фундаментальное разложение не единственно, но размерности положительной и отрицательной части разложения всегда одинаковы.

Каждому фундаментальному разложению $X = X^+ \oplus X^-$ соответствует гильбертово пространство $|X| = X^+ \oplus |X^-|$. Как известно, в гильбертовом пространстве всегда можно определить норму $\| \cdot \|$, порожденную скалярным произведением. Можно показать, что нормы для гильбертовых пространств, соответствующих разным фундаментальным разложениям эквивалентны. Пользуясь этим, определим сильную топологию в $X$ как топологию в гильбертовом пространстве $|X|$. Топологические свойства для данной топологии назовем сильными (сильная непрерывность, сильная сходимость).

Пространство Понтрягина (понтрягинское пространство) — пространство Крейна $\Pi$, в котором размерность $\Pi^-$ конечна. $\dim \Pi^-$ называется индексом $X$. В этой терминологии, гильбертово пространство имеет индекс $0$, пространство Минковского имеет индекс $1$.

Предпонтрягинское пространство — линейное пространство $\mcP$ с невырожденным индефинитным скалярным произведением, такое что $\mcP$ содержит максимальное отрицательное подпространство конечной размерности. \todo{чо?}

Предпонтрягинское пространство может быть пополнено в понтрягинское: для любого предпонтрягинского пространства $\mcP$ с максимальным отрицательным подпространстом размерности $k$ существует понтрягинское простарнство $\Pi$ индекса $k$, такое что $\mcP$ плотно в $\Pi$.

$[f, g] = \ip{J f}{g}$, $J = P_+ - P_-$


\section{Обобщенные точечные взаимодействия}
В физике часто бывает просто работать с сингулярными объектами, а после их анализа некоторым образом комбинировать решения сингулярных задач, чтобы получать решения исходных. К примеру, можно рассматривать состояния рассеяния для уравнения Шредингера, которые не лежат в $\mcL^2$, а после получения решения для состояний рассеяния, записать волновой пакет как свертку этих состояний, которая уже лежит в $\mcL^2$. \todo{мутно}

Опишем способ добавления обобщенной функции $\psi$ к области определения оператора $H$, который реализован в работах \cite{van1991scattering, dijksma2000self, dijksma2000singular}.

\subsection{Шкалы гильбертовых пространств}
Пусть $A$ — самосопряженный оператор с резольвентой $R(z) = \frac{1}{A - z}$, действующий в гильбертовом пространстве $(\hilb{0}, \ipcdot_0)$.

Выберем произвольную точку $z_0$ из резольвентного множества оператора $A$ (дальнейшие построения не зависят от выбора конкретной точки), и для краткости записи, обозначим оператор $R(z_0)$ за $Z_0$.

\subsubsection{Положительная шкала}
Для $k > 0$, определим $\hilb{k} = Z_0^k \hilb{0} = \{ Z_0^k \phi \mid \phi \in \hilb{0} \}$. Можно показать, что $\hilb{1}$ — плотное подмножество $\hilb{0}$, и продолжить это по индукции для любых $\hilb{i}$ и $\hilb{j}$, $i > j$. В каждом $\hilb{k}$ можно определить внутреннее скалярное произведение $\ip{f}{g}_k = \ip{Z_0^{-k} f}{Z_0^{-k} g}$ и норму $\|f\|_k = \sqrt{\ip{f}{f}_k}$.

\subsubsection{Отрицательная шкала}
Для $k > 0$, определим $\hilb{-k}$ как пополнение пространства $\hilb{0}$ по норме $\|f \|_{-k} = \sup\limits_{u \in \hilb{k}} \frac{\ip{f}{u}_0}{\|u\|_j}$. Фактически, это пространство, сопряженное к $\hilb{k}$, то есть пространство непрерывных антилинейных функционалов $\{ f: \hilb{k} \to \bbC \}$. Для любого $f \in \hilb{-k}$ будет существовать последовательность $f_n \in \hilb{0}$, сходящаяся к $f$ по норме $\|\cdot\|_{-k}$, такая что для произвольного $g \in \hilb{k}$ существует предел $\lim\limits_{n \to \infty} \ip{\psi_n}{g}_0$. Таким образом, мы можем продолжить скалярное произведение $\ipcdot_0$ на пары элементов $\hilb{-k} \times \hilb{k}$. В частности, для таких пар будет выполняться неравенство Шварца: $|\ip{f}{g}_0| \le \|f\|_{-k} \|g\|_k$.
% \item Let us denote the elements of $\hilb{k}$ as ket vectors, that is, $\ket{\psi} \in \hilb{k}$.

\subsection{Предпонтрягинское пространство $\mcP$}
Для того, чтобы дать интерпретацию действию оператора $A$ на элементе $\psi$, надо расширить гильбертово пространство $\hilb{0}$ обобщенным элементом $\psi$ (обозначим за $m$ минимальное положительное число, такое что $\psi \in \hilb{-m}$), и опрелить оператор $A$ в расширенном пространстве. Для начала, нам необходимо пространство $\mcP$, сочетающее следующие свойства:

\begin{elist}
# содержит обобщенный элемент $\psi$;
# содержит как можно меньше «лишних элементов» из  $\hilb{-m} \setminus \hilb{0}$;
# содержит как можно больше элементов из $\hilb{0}$;
# скалярное произведение $\ipcdot_\mcP$ на $\mcP$ должно расширять скалярное произведение $\ipcdot_0$;
# $R(z)$ должно быть резольвентой самосопряженного оператора в $\mcP$.
\end{elist}

Определим искомое пространство как:
\[
\mcP = 
\{ f = f_\phi + \sum\limits_{i = -m}^{m - 1} f_i \psi_i \mid f_\phi \in \hilb{m}, f_i \in \bbC\}
\]

, где $\psi_i = Z_0^{m + i} \psi$, то есть, $\psi_i \in \hilb{i}$.

Определим индефинитное скалярное произведение:

\[
\ip{f}{g}_\mcP =
\ip{f_\phi}{g_\phi}_0 +
\sum\limits_{i = -m}^{m - 1} \ip{f_i \psi_i}{f_\phi}_0 +
\sum\limits_{j = -m}^{m - 1} \ip{g_\phi}{g_j \psi_j}_0 +
\sum\limits_{i = -m}^{m - 1} \sum\limits_{j = -m}^{m - 1} \cconj{f_i} G_{ij} g_j
\]
, где $G_{ij}$ формально равен $\ip{\psi_i}{\psi_j}_0$. Не все элементы матрицы $G$ определены (как минимум, $G_{-m, -m}$), в их выборе у нас есть некоторая свобода. На матрицу $G$ наложены некоторые ограничения:

\begin{itemize}
\item $G$ — эрмитова матрица, что необходимо для эрмитовой симметричности;
\item некоторые из элементов $G$ могут быть корректно определены, если $\psi_i$ и $\psi_j$ совместны. В частности, всегда можно корректно определить элементы $G_{i, j}$, для которых $i + j \ge 0$;
\item для того, чтобы оператор $A$ в понтрягинском пространстве был самосопряженным, должно выполняться:
\[
G_{i, j} = \frac{G_{i - 1, j} - G_{i, j - 1}}{z_0 - \cconj{z_0}}
\]
\end{itemize}

После этого остается $2 m$ свободных параметров, которые должны быть зафиксированы из неких физических соображений. К примеру, может быть использована так называемая «ренормализация» расходящихся интегралов, техника, применяемая в квантовой теории поля, которая, в частности, была использована в статье \cite{berezin1963models}.

\subsection{Понтрягинское пространство $\Pi$}
В пространстве $\mcP$ все еще недостаточно структуры, так как:
\begin{ilist}
# оно содержит не все элементы $\hilb{0}$, что плохо с физической точки зрения;
# в нем не определена топология, что плохо с математической точки зрения.
\end{ilist}

Приведем форму $\ipcdot_\mcP$ к диагональному виду: \todo{Шондин2, страница 256}. Рассмотрим норму, порожденную гильбертовым пространством - модулем $\mcP$, и пополним $\mcP$ в топологии этого гильбертова пространства. Полученное пространство $\Pi$ будет прямой ортогональной суммой положительного гильбертова пространства $\Pi_+ = \hilb{0} \oplus \bbC^m$ и отрицательного $\Pi_- = \bbC^m$, то есть пространством Понтрягина.

Для того чтобы решить эти проблемы, предпонтрягинское пространство будет пополнено в понтрягинское.

Определим 
\[
\Pi = \{f = (\phi_f, \vb{p_f}, \vb{n_f}) \mid \phi_f \in \hilb{0}, \vb{p_f} \in \bbC^m, \vb{n_f} \in \bbC^m \}
\]
с индефинитным скалярным произведением
\[
\ip{f}{g} =
\ip{\phi_f}{\phi_g}_0 +
\cconj{\vb{p_f}} \vdot \vb{n_g} +
\cconj{\vb{n_f}} \vdot \vb{p_g} + 
\cconj{\vb{n_f}} \vdot \vb{g_{ij}} \vdot \vb{n_g}
\]

Топология в этом пространстве определяется как топология произведения в $\hilb{0} \oplus \bbC^m \oplus \bbC^m$.

Пусть $\vb{g_{ij}}$ — та самая матрица $g$ из $\mathcal{P}_m$. 

\begin{theorem}
Топологическим пополнием $\mathcal{P}_m$ является выше определенное пространство $\Pi_m$.
\end{theorem}

Доказательство: \todo{Шондин2, страница 256}

Вложим $\mcP$ в $\Pi$ следующим образом:

\[
\phi_m + \sum\limits_{i = -m}^{m - 1} c_i \psi_i \mapsto
\left(
\phi_m + \sum\limits_{i = 0}^{m - 1} c_i \psi_i,
\left[ \ip{\psi_i}{\phi_m}_0 + \sum\limits_{j = 0}^{m - 1} c_j g_{ij} \right]_{i = -1}^{-m},
\left[ c_i \right]_{i = -1}^{-m}
\right)
\]
\todo{У Шондина есть что-то про унитарную группу в пространстве Понтрягина}

Физически обосновано понтрягинское пространствно  пространство следующей теоремой (доказательство есть в работе \cite{pontryagin1944hermetian}): для любого самосопряженного оператора в понтрягинском пространстве $\Pi$ с $k$ отрицательными квадратами существует инвариантное неположительное подпространствно размерности $k$.

Пользуясь этой теоремой, можно определить физическое пространство состояний с положительно определенным скалярным произведением, которое допускает вероятностную интерпретацию, следующим образом:
\begin{elist}
# выбираем инвариантное отрицательное подпространство $L$, пусть $L_0$ — его изотропная часть;
# $L_0$ и $L_\perp$ — инвариантны в силу самосопряженности, при этом $L^\perp$ — неотрицательно, $L_0 \subseteq L^\perp$;
# определим физическое пространство $\hilb{+}$ как фактор-пространство $L^\perp / L_0$.
\end{elist}
$\hilb{+}$ будет являться гильбертовым пространством, и также будет инвариантно относительно действия оператора.

На пространство $\Pi$ естественным образом продолжаются резольвента и гамильтониан с помощью замыкания их образа на пространстве $\mcP$. \todo{ссылку на Шондина}